<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>IPD Workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">IPD Workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> <i class="bi bi-fa-home" role="img">
</i> 
<span class="menu-text">Inference with Predicted Data (IPD) Workshop</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-getting-started" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Getting Started</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-getting-started">    
        <li>
    <a class="dropdown-item" href="./content/Unit00_GettingStarted.html">
 <span class="dropdown-text">Workshop Material</span></a>
  </li>  
        <li class="dropdown-header">Activity</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-the-rashomon-quartet" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">The Rashomon Quartet</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-the-rashomon-quartet">    
        <li>
    <a class="dropdown-item" href="./content/Unit01_RashomonQuartet.html">
 <span class="dropdown-text">Workshop Material</span></a>
  </li>  
        <li class="dropdown-header">Activity</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-measuring-adiposity" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Measuring Adiposity</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-measuring-adiposity">    
        <li>
    <a class="dropdown-item" href="./content/Unit02_MeasuringAdiposity.html">
 <span class="dropdown-text">Workshop Material</span></a>
  </li>  
        <li class="dropdown-header">Activity</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bcr-abl-fusion-in-b-cell-leukemia" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">BCR-ABL Fusion in B-Cell Leukemia</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bcr-abl-fusion-in-b-cell-leukemia">    
        <li>
    <a class="dropdown-item" href="./content/Unit03_GeneticData.html">
 <span class="dropdown-text">Workshop Material</span></a>
  </li>  
        <li class="dropdown-header">Activity</li>
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#inference-with-predicted-data-ipd-workshop" id="toc-inference-with-predicted-data-ipd-workshop" class="nav-link active" data-scroll-target="#inference-with-predicted-data-ipd-workshop">Inference with Predicted Data (IPD) Workshop</a>
  <ul class="collapse">
  <li><a href="#background-and-motivation" id="toc-background-and-motivation" class="nav-link" data-scroll-target="#background-and-motivation">Background and Motivation</a></li>
  <li><a href="#workshop-overview" id="toc-workshop-overview" class="nav-link" data-scroll-target="#workshop-overview">Workshop Overview</a>
  <ul class="collapse">
  <li><a href="#participation" id="toc-participation" class="nav-link" data-scroll-target="#participation">Participation</a></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">Prerequisites</a></li>
  <li><a href="#r-bioconductor-packages-used" id="toc-r-bioconductor-packages-used" class="nav-link" data-scroll-target="#r-bioconductor-packages-used"><em>R</em> / <em>Bioconductor</em> Packages Used</a></li>
  <li><a href="#time-outline-90-minutes" id="toc-time-outline-90-minutes" class="nav-link" data-scroll-target="#time-outline-90-minutes">Time Outline (90 minutes)</a></li>
  <li><a href="#workshop-goals-and-objectives" id="toc-workshop-goals-and-objectives" class="nav-link" data-scroll-target="#workshop-goals-and-objectives">Workshop Goals and Objectives</a></li>
  </ul></li>
  <li><a href="#workshop-environment" id="toc-workshop-environment" class="nav-link" data-scroll-target="#workshop-environment">Workshop Environment</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="inference-with-predicted-data-ipd-workshop" class="level1">
<h1>Inference with Predicted Data (IPD) Workshop</h1>
<blockquote class="blockquote">
<p>What do we do after we have machine learned everything?</p>
</blockquote>
<p><strong>Presenters:</strong> Jesse Gronsbell<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Stephen Salerno<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><strong>Contributors (Alphabetical Order):</strong> Awan Afiaz<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, David Cheng<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, Jianhui Gao<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>, Jesse Gronsbell<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>, Kentaro Hoffman<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>, Jeff Leek<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>, Qiongshi Lu<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>, Tyler McCormick<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>, Jiacheng Miao<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>,<br>
Anna Neufeld<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>, Stephen Salerno<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
<p><strong>Workshop Date:</strong> June 24, 2025</p>
<hr>
<section id="background-and-motivation" class="level2">
<h2 class="anchored" data-anchor-id="background-and-motivation">Background and Motivation</h2>
<p>Artificial intelligence and machine learning (AI/ML) have become essential tools in biomedical research, enabling large-scale analyses across diverse domains such as genomics, structural biology, and electronic health records-based research. Increasingly, researchers rely on model-generated predictions, rather than directly measured variables, as inputs for downstream statistical analyses. For example, predicted gene expression values or polygenic risk scores are often used in place of experimental assays, allowing researchers to expand cohort sizes and explore hypotheses when traditional data collection is infeasible, costly, or time-consuming.</p>
<p>While this practice of “using predictions as data” holds promise for accelerating scientific discovery, it presents significant challenges for statistical inference. When predicted values are used in place of true variables, the resulting estimates of association can be biased and misleading if uncertainty in the prediction step is not properly accounted for.</p>
</section>
<section id="workshop-overview" class="level2">
<h2 class="anchored" data-anchor-id="workshop-overview">Workshop Overview</h2>
<p>In this workshop, we explore the consequences of inference on predicted data across several biomedical applications. Drawing from classical approaches to measurement error and recent developments in bias correction, we will present a suite of prediction-based inference methods that adjust for prediction-related uncertainty and improve inference validity and efficiency. We will also introduce <a href="https://github.com/ipd-tools/ipd"><code>ipd</code></a>, a user-friendly R package that implements several of these correction methods through a unified interface. The package supports modular integration into existing workflows and includes <a href="https://broom.tidymodels.org/index.html"><code>tidy</code></a> methods for model inspection and diagnostics.</p>
<p>This workshop covers four modules (time permitting), each illustrating IPD in R using the <a href="https://github.com/ipd-tools/ipd"><code>ipd</code></a> package:</p>
<ol type="1">
<li><p><a href="https://salernos.github.io/ipdworkshop/articles/Unit00_GettingStarted.html"><strong>Unit 00: Getting Started</strong></a></p>
<ul>
<li><strong>Introduce</strong> IPD concepts and core <a href="https://github.com/ipd-tools/ipd"><code>ipd</code></a> package functions</li>
<li><strong>Simulate</strong> data and explore the bias and variance of AI/ML predictions versus ‘real’ data</li>
<li><strong>Fit</strong> naive and classical inference models and compare with IPD methods</li>
</ul></li>
</ol>
<p><br></p>
<ol start="2" type="1">
<li><p><a href="https://salernos.github.io/ipdworkshop/articles/Unit01_RashomonQuartet.html"><strong>Unit 01: The Rashomon Quartet</strong></a></p>
<ul>
<li><strong>Train</strong> multiple prediction models on the <a href="https://github.com/MI2DataLab/rashomon-quartet">Rashomon Quartet</a> training set</li>
<li><strong>Compare</strong> the performances of the upstream predictions on the <a href="https://github.com/MI2DataLab/rashomon-quartet">Rashomon Quartet</a> testing set</li>
<li><strong>Recover</strong> classical estimates using IPD and contrast with naive estimates</li>
</ul></li>
</ol>
<p><br></p>
<ol start="3" type="1">
<li><p><a href="https://salernos.github.io/ipdworkshop/articles/Unit02_BMIvDXA.html"><strong>Unit 02: Different Measures of Adiposity</strong></a></p>
<ul>
<li><strong>Explore</strong> the <a href="https://www.cdc.gov/nchs/nhanes/index.html">National Health and Nutrition Examination Survey (NHANES)</a> pre- and post- COVID-19</li>
<li><strong>Define</strong> obesity based body mass index, waist circumference, and gold-standard dual-energy X-ray absorptiometry</li>
<li><strong>Demonstrate</strong> how conclusions differ for naive, classical, and IPD logistic regression</li>
</ul></li>
</ol>
<p><br></p>
<ol start="4" type="1">
<li><p><a href="https://salernos.github.io/ipdworkshop/articles/Unit03_GeneticData.html"><strong>Unit 03: BCR-ABL Fusion in B-Cell Leukemia</strong></a></p>
<ul>
<li><strong>Learn</strong> gene expression classifiers for <a href="https://www.bioconductor.org/packages/release/data/experiment/html/ALL.html">acute lymphoblastic leukemia (ALL)</a> genetic subtypes</li>
<li><strong>Harmonize</strong> features across two studies (<a href="https://www.bioconductor.org/packages/release/data/experiment/html/ALL.html"><code>ALL</code></a> and <a href="https://www.bioconductor.org/packages/release/data/experiment/html/golubEsets.html"><code>Golub</code></a>) and predict BCR-ABL1 (Philadelphia chromosome) fusion status</li>
<li><strong>Perform</strong> IPD to estimate associations between fusion status and clinical risk factors</li>
</ul></li>
</ol>
<section id="participation" class="level3">
<h3 class="anchored" data-anchor-id="participation">Participation</h3>
<p>This 90-minute workshop uses a blended format of <strong>instruction</strong> and <strong>hands-on coding exercises</strong>. Participants should:</p>
<ul>
<li>Follow along in the virtual RStudio environment (see below).</li>
<li>Attempt to complete brief exercises or run the solution code snippets in real time.</li>
<li>Engage in Q&amp;A at module boundaries to troubleshoot and discuss concepts.</li>
</ul>
</section>
<section id="prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites">Prerequisites</h3>
<ul>
<li>A computer with internet to access the <strong>RStudio Virtual Environment</strong> (see below).</li>
<li>Familiarity with <strong>base R</strong> and <strong>tidyverse</strong> syntax (e.g., <code>dplyr</code>, <code>broom</code>).</li>
<li>Basic understanding of predictive (e.g., <code>randomForest</code>) and regression modeling (e.g., <code>lm</code>, <code>glm</code>).</li>
<li>Exposure to Bioconductor’s <strong>ExpressionSet</strong>, <strong>AnnotationDbi</strong>, and <code>MLInterfaces</code> is helpful for the last module.</li>
</ul>
</section>
<section id="r-bioconductor-packages-used" class="level3">
<h3 class="anchored" data-anchor-id="r-bioconductor-packages-used"><em>R</em> / <em>Bioconductor</em> Packages Used</h3>
<ul>
<li><p><em>Datasets</em>: <code>nhanesA</code>, <code>ALL</code>, <code>golubEsets</code>, <code>AnnotationDbi</code>, <code>hgu95av2.db</code>, <code>hu6800.db</code></p></li>
<li><p><em>Data Manipulation and Visualization</em>: <code>broom</code>, <code>scales</code>, <code>janitor</code>, <code>GGally</code>, <code>patchwork</code>, <code>tidyverse</code></p></li>
<li><p><em>Predictive Modeling:</em> <code>neuralnet</code>, <code>partykit</code>, <code>randomForest</code>, <code>ranger</code>, <code>mgcv</code>, <code>pROC</code>, <code>DALEX</code>, <code>MLInterfaces</code></p></li>
<li><p><em>Inference with Predicted Data:</em> <code>ipd</code></p></li>
</ul>
</section>
<section id="time-outline-90-minutes" class="level3">
<h3 class="anchored" data-anchor-id="time-outline-90-minutes">Time Outline (90 minutes)</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Activity</th>
<th>Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Brief Overview of the Problem</td>
<td>15 m</td>
</tr>
<tr class="even">
<td><a href="https://salernos.github.io/ipdworkshop/articles/Unit00_GettingStarted.html">Unit 00: Getting Started</a></td>
<td>15 m</td>
</tr>
<tr class="odd">
<td><a href="https://salernos.github.io/ipdworkshop/articles/Unit01_RashomonQuartet.html">Unit 01: The Rashomon Quartet</a></td>
<td>15 m</td>
</tr>
<tr class="even">
<td><a href="https://salernos.github.io/ipdworkshop/articles/Unit02_BMIvDXA.html">Unit 02: Different Measures of Adiposity</a></td>
<td>15 m</td>
</tr>
<tr class="odd">
<td><a href="https://salernos.github.io/ipdworkshop/articles/Unit03_GeneticData.html">Unit 03: BCR-ABL Fusion in B-Cell Leukemia</a></td>
<td>15 m</td>
</tr>
<tr class="even">
<td>Wrap-Up and Q&amp;A</td>
<td>15 m</td>
</tr>
</tbody>
</table>
</section>
<section id="workshop-goals-and-objectives" class="level3">
<h3 class="anchored" data-anchor-id="workshop-goals-and-objectives">Workshop Goals and Objectives</h3>
<p><em>Learning Goals:</em></p>
<ul>
<li><strong>Understand</strong> the limitations of using predicted data for inference.</li>
<li><strong>Learn</strong> how IPD methods adjust for bias and recover valid uncertainty estimates.</li>
<li><strong>Gain</strong> practical skills with the <a href="https://github.com/ipd-tools/ipd"><code>ipd</code></a> R package across simulated and real datasets.</li>
</ul>
<p><em>Learning Objectives:</em> By the end of the workshop, participants will be able to:</p>
<ul>
<li><strong>Train</strong> and evaluate predictive models (LDA, neural nets, random forests) using R and Bioconductor workflows.</li>
<li><strong>Explore</strong> data with AI/ML-predicted outcomes and diagnose bias/variance in predictions.</li>
<li><strong>Apply</strong> <code>ipd::ipd()</code> for continuous and binary outcomes to correct inference using predicted data.</li>
<li><strong>Interpret</strong> IPD outputs and visualize adjusted coefficient estimates with confidence intervals.</li>
</ul>
</section>
</section>
<section id="workshop-environment" class="level2">
<h2 class="anchored" data-anchor-id="workshop-environment">Workshop Environment</h2>
<p>The companion website for this workshop is available at:</p>
<p><a href="https://salernos.github.io/ipdworkshop">https://salernos.github.io/ipdworkshop</a></p>
<p>To use the workshop image:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-e</span> PASSWORD=<span class="op">&lt;</span>choose_a_password_for_rstudio<span class="op">&gt;</span> -p 8787:8787 ghcr.io/salernos/ipdworkshop:latest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Once running, navigate to http://localhost:8787/ and then login with <code>rstudio</code>:<code>yourchosenpassword</code>.</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="mailto:j.gronsbell@utoronto.ca">j.gronsbell@utoronto.ca</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><a href="mailto:ssalerno@fredhutch.org">ssalerno@fredhutch.org</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a href="mailto:aafiaz@uw.edu">aafiaz@uw.edu</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><a href="mailto:dcheng@mgh.harvard.edu">dcheng@mgh.harvard.edu</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><a href="mailto:jianhui.gao@mail.utoronto.ca">jianhui.gao@mail.utoronto.ca</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p><a href="mailto:j.gronsbell@utoronto.ca">j.gronsbell@utoronto.ca</a><a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p><a href="mailto:khoffm3@uw.edu">khoffm3@uw.edu</a><a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p><a href="mailto:jtleek@fredhutch.org">jtleek@fredhutch.org</a><a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p><a href="mailto:qlu@biostat.wisc.edu">qlu@biostat.wisc.edu</a><a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p><a href="mailto:tylermc@uw.edu">tylermc@uw.edu</a><a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p><a href="mailto:jmiao24@wisc.edu">jmiao24@wisc.edu</a><a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p><a href="mailto:acn2@williams.edu">acn2@williams.edu</a><a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p><a href="mailto:ssalerno@fredhutch.org">ssalerno@fredhutch.org</a><a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>